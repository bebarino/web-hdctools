let e,n,t,r,a,i,o,s,l=e=>e;import{objectSpread2 as c}from"./5522257c.js";import{_ as u,f as m,M as f,g as d,q as p,p as _,i as g,B as h,h as b,j as y,d as v,k as w,s as L,b as C}from"./3ebe09e0.js";import{P as S}from"./c315ff30.js";var k={animation:{prefixed:"-webkit-animation",standard:"animation"},transform:{prefixed:"-webkit-transform",standard:"transform"},transition:{prefixed:"-webkit-transition",standard:"transition"}};function A(e,n){if(function(e){return Boolean(e.document)&&"function"==typeof e.document.createElement}(e)&&n in k){var t=e.document.createElement("div"),r=k[n],a=r.standard,i=r.prefixed;return a in t.style?a:i}return n}var R={CLOSED_CLASS:"mdc-linear-progress--closed",INDETERMINATE_CLASS:"mdc-linear-progress--indeterminate",REVERSED_CLASS:"mdc-linear-progress--reversed"},E={ARIA_VALUENOW:"aria-valuenow",BUFFER_BAR_SELECTOR:".mdc-linear-progress__buffer-bar",FLEX_BASIS:"flex-basis",PRIMARY_BAR_SELECTOR:".mdc-linear-progress__primary-bar"},x=function(e){function n(t){return e.call(this,m(m({},n.defaultAdapter),t))||this}return u(n,e),Object.defineProperty(n,"cssClasses",{get:function(){return R},enumerable:!0,configurable:!0}),Object.defineProperty(n,"strings",{get:function(){return E},enumerable:!0,configurable:!0}),Object.defineProperty(n,"defaultAdapter",{get:function(){return{addClass:function(){},forceLayout:function(){},setBufferBarStyle:function(){return null},setPrimaryBarStyle:function(){return null},hasClass:function(){return!1},removeAttribute:function(){},removeClass:function(){},setAttribute:function(){}}},enumerable:!0,configurable:!0}),n.prototype.init=function(){this.isDeterminate_=!this.adapter_.hasClass(R.INDETERMINATE_CLASS),this.isReversed_=this.adapter_.hasClass(R.REVERSED_CLASS),this.progress_=0,this.buffer_=1},n.prototype.setDeterminate=function(e){if(this.isDeterminate_=e,this.isDeterminate_)return this.adapter_.removeClass(R.INDETERMINATE_CLASS),this.adapter_.setAttribute(E.ARIA_VALUENOW,this.progress_.toString()),this.setPrimaryBarProgress_(this.progress_),void this.setBufferBarProgress_(this.buffer_);this.isReversed_&&(this.adapter_.removeClass(R.REVERSED_CLASS),this.adapter_.forceLayout(),this.adapter_.addClass(R.REVERSED_CLASS)),this.adapter_.addClass(R.INDETERMINATE_CLASS),this.adapter_.removeAttribute(E.ARIA_VALUENOW),this.setPrimaryBarProgress_(1),this.setBufferBarProgress_(1)},n.prototype.isDeterminate=function(){return this.isDeterminate_},n.prototype.setProgress=function(e){this.progress_=e,this.isDeterminate_&&(this.setPrimaryBarProgress_(e),this.adapter_.setAttribute(E.ARIA_VALUENOW,e.toString()))},n.prototype.getProgress=function(){return this.progress_},n.prototype.setBuffer=function(e){this.buffer_=e,this.isDeterminate_&&this.setBufferBarProgress_(e)},n.prototype.setReverse=function(e){this.isReversed_=e,this.isDeterminate_||(this.adapter_.removeClass(R.INDETERMINATE_CLASS),this.adapter_.forceLayout(),this.adapter_.addClass(R.INDETERMINATE_CLASS)),this.isReversed_?this.adapter_.addClass(R.REVERSED_CLASS):this.adapter_.removeClass(R.REVERSED_CLASS)},n.prototype.open=function(){this.adapter_.removeClass(R.CLOSED_CLASS)},n.prototype.close=function(){this.adapter_.addClass(R.CLOSED_CLASS)},n.prototype.setPrimaryBarProgress_=function(e){var n="scaleX("+e+")",t="undefined"!=typeof window?A(window,"transform"):"transform";this.adapter_.setPrimaryBarStyle(t,n)},n.prototype.setBufferBarProgress_=function(e){var n=100*e+"%";this.adapter_.setBufferBarStyle(E.FLEX_BASIS,n)},n}(f);class F extends h{constructor(){super(...arguments),this.mdcFoundationClass=x,this.indeterminate=!1,this.progress=0,this.buffer=1,this.reverse=!1,this.closed=!1,this.ariaLabel=""}render(){return b(e||(e=l` <div role="progressbar" class="mdc-linear-progress" aria-label="${0}" aria-valuemin="0" aria-valuemax="1" aria-valuenow="0"> <div class="mdc-linear-progress__buffer"> <div class="mdc-linear-progress__buffer-bar"></div> <div class="mdc-linear-progress__buffer-dots"></div> </div> <div class="mdc-linear-progress__bar mdc-linear-progress__primary-bar"> <span class="mdc-linear-progress__bar-inner"></span> </div> <div class="mdc-linear-progress__bar mdc-linear-progress__secondary-bar"> <span class="mdc-linear-progress__bar-inner"></span> </div> </div>`),this.ariaLabel)}createAdapter(){return Object.assign(Object.assign({},y(this.mdcRoot)),{forceLayout:()=>this.mdcRoot.offsetWidth,removeAttribute:e=>{this.mdcRoot.removeAttribute(e)},setAttribute:(e,n)=>{this.mdcRoot.setAttribute(e,n)},setBufferBarStyle:(e,n)=>{this.bufferElement.style[e]=n},setPrimaryBarStyle:(e,n)=>{this.primaryBar.style[e]=n}})}open(){this.closed=!1}close(){this.closed=!0}}d([p(".mdc-linear-progress")],F.prototype,"mdcRoot",void 0),d([p(".mdc-linear-progress__primary-bar")],F.prototype,"primaryBar",void 0),d([p(".mdc-linear-progress__buffer-bar")],F.prototype,"bufferElement",void 0),d([_({type:Boolean,reflect:!0}),g((function(e){this.mdcFoundation.setDeterminate(!e)}))],F.prototype,"indeterminate",void 0),d([_({type:Number}),g((function(e){this.mdcFoundation.setProgress(e)}))],F.prototype,"progress",void 0),d([_({type:Number}),g((function(e){this.mdcFoundation.setBuffer(e)}))],F.prototype,"buffer",void 0),d([_({type:Boolean,reflect:!0}),g((function(e){this.mdcFoundation.setReverse(e)}))],F.prototype,"reverse",void 0),d([_({type:Boolean,reflect:!0}),g((function(e){e?this.mdcFoundation.close():this.mdcFoundation.open()}))],F.prototype,"closed",void 0),d([_()],F.prototype,"ariaLabel",void 0);const M=v(n||(n=l`@keyframes mdc-linear-progress-primary-indeterminate-translate{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(.5,0,.701732,.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(.302435,.381352,.55,.956352);transform:translateX(83.67142%)}100%{transform:translateX(200.611057%)}}@keyframes mdc-linear-progress-primary-indeterminate-scale{0%{transform:scaleX(.08)}36.65%{animation-timing-function:cubic-bezier(.334731,.12482,.785844,1);transform:scaleX(.08)}69.15%{animation-timing-function:cubic-bezier(.06,.11,.6,1);transform:scaleX(.661479)}100%{transform:scaleX(.08)}}@keyframes mdc-linear-progress-secondary-indeterminate-translate{0%{animation-timing-function:cubic-bezier(.15,0,.515058,.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(.31033,.284058,.8,.733712);transform:translateX(37.651913%)}48.35%{animation-timing-function:cubic-bezier(.4,.627035,.6,.902026);transform:translateX(84.386165%)}100%{transform:translateX(160.277782%)}}@keyframes mdc-linear-progress-secondary-indeterminate-scale{0%{animation-timing-function:cubic-bezier(.205028,.057051,.57661,.453971);transform:scaleX(.08)}19.15%{animation-timing-function:cubic-bezier(.152313,.196432,.648374,1.004315);transform:scaleX(.457104)}44.15%{animation-timing-function:cubic-bezier(.257759,-.003163,.211762,1.38179);transform:scaleX(.72796)}100%{transform:scaleX(.08)}}@keyframes mdc-linear-progress-buffering{from{transform:rotate(180deg) translateX(-10px)}}@keyframes mdc-linear-progress-primary-indeterminate-translate-reverse{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(.5,0,.701732,.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(.302435,.381352,.55,.956352);transform:translateX(-83.67142%)}100%{transform:translateX(-200.611057%)}}@keyframes mdc-linear-progress-secondary-indeterminate-translate-reverse{0%{animation-timing-function:cubic-bezier(.15,0,.515058,.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(.31033,.284058,.8,.733712);transform:translateX(-37.651913%)}48.35%{animation-timing-function:cubic-bezier(.4,.627035,.6,.902026);transform:translateX(-84.386165%)}100%{transform:translateX(-160.277782%)}}@keyframes mdc-linear-progress-buffering-reverse{from{transform:translateX(-10px)}}.mdc-linear-progress{position:relative;width:100%;height:4px;transform:translateZ(0);outline:1px solid transparent;overflow:hidden;transition:opacity 250ms 0s cubic-bezier(.4,0,.6,1)}.mdc-linear-progress__bar{position:absolute;width:100%;height:100%;animation:none;transform-origin:top left;transition:transform 250ms 0s cubic-bezier(.4,0,.6,1)}.mdc-linear-progress__bar-inner{display:inline-block;position:absolute;width:100%;animation:none;border-top:4px solid}.mdc-linear-progress__buffer{display:flex;position:absolute;width:100%;height:100%}.mdc-linear-progress__buffer-dots{background-repeat:repeat-x;background-size:10px 4px;flex:auto;transform:rotate(180deg);animation:mdc-linear-progress-buffering 250ms infinite linear}.mdc-linear-progress__buffer-bar{flex:0 1 100%;transition:flex-basis 250ms 0s cubic-bezier(.4,0,.6,1)}.mdc-linear-progress__primary-bar{transform:scaleX(0)}.mdc-linear-progress__secondary-bar{visibility:hidden}.mdc-linear-progress--indeterminate .mdc-linear-progress__bar{transition:none}.mdc-linear-progress--indeterminate .mdc-linear-progress__primary-bar{left:-145.166611%;animation:mdc-linear-progress-primary-indeterminate-translate 2s infinite linear}.mdc-linear-progress--indeterminate .mdc-linear-progress__primary-bar>.mdc-linear-progress__bar-inner{animation:mdc-linear-progress-primary-indeterminate-scale 2s infinite linear}.mdc-linear-progress--indeterminate .mdc-linear-progress__secondary-bar{left:-54.888891%;visibility:visible;animation:mdc-linear-progress-secondary-indeterminate-translate 2s infinite linear}.mdc-linear-progress--indeterminate .mdc-linear-progress__secondary-bar>.mdc-linear-progress__bar-inner{animation:mdc-linear-progress-secondary-indeterminate-scale 2s infinite linear}.mdc-linear-progress--reversed .mdc-linear-progress__bar{right:0;transform-origin:center right}.mdc-linear-progress--reversed .mdc-linear-progress__primary-bar{animation-name:mdc-linear-progress-primary-indeterminate-translate-reverse}.mdc-linear-progress--reversed .mdc-linear-progress__secondary-bar{animation-name:mdc-linear-progress-secondary-indeterminate-translate-reverse}.mdc-linear-progress--reversed .mdc-linear-progress__buffer-dots{animation:mdc-linear-progress-buffering-reverse 250ms infinite linear;order:0;transform:rotate(0)}.mdc-linear-progress--reversed .mdc-linear-progress__buffer-bar{order:1}.mdc-linear-progress--closed{opacity:0;animation:none}.mdc-linear-progress__bar-inner{border-color:#6200ee;border-color:var(--mdc-theme-primary,#6200ee)}.mdc-linear-progress__buffer-dots{background-image:url("data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' enable-background='new 0 0 5 2' xml:space='preserve' viewBox='0 0 5 2' preserveAspectRatio='none slice'%3E%3Ccircle cx='1' cy='1' r='1' fill='%23e6e6e6'/%3E%3C/svg%3E")}.mdc-linear-progress__buffer-bar{background-color:#e6e6e6}.mdc-linear-progress--indeterminate.mdc-linear-progress--reversed .mdc-linear-progress__primary-bar{right:-145.166611%;left:auto}.mdc-linear-progress--indeterminate.mdc-linear-progress--reversed .mdc-linear-progress__secondary-bar{right:-54.888891%;left:auto}:host{display:block}.mdc-linear-progress__buffer-bar{background-color:#e6e6e6;background-color:var(--mdc-linear-progress-buffer-color,#e6e6e6)}.mdc-linear-progress__buffer-dots{background-image:url("data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' enable-background='new 0 0 5 2' xml:space='preserve' viewBox='0 0 5 2' preserveAspectRatio='none slice'%3E%3Ccircle cx='1' cy='1' r='1' fill='%23e6e6e6'/%3E%3C/svg%3E");background-image:var(--mdc-linear-progress-buffering-dots-image, url("data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' enable-background='new 0 0 5 2' xml:space='preserve' viewBox='0 0 5 2' preserveAspectRatio='none slice'%3E%3Ccircle cx='1' cy='1' r='1' fill='%23e6e6e6'/%3E%3C/svg%3E"))}`));let D=class extends F{};D.styles=M,D=d([w("mwc-linear-progress")],D);const P={url:new URL("./src/libflashrom.mjs",import.meta.url).href};var I,z=(I=P.url,function(e){var n,t=void 0!==(e=e||{})?e:{},r={};for(n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);var a,i=function(e,n){throw n},o="";document.currentScript&&(o=document.currentScript.src),I&&(o=I),o=0!==o.indexOf("blob:")?o.substr(0,o.lastIndexOf("/")+1):"",a=function(e,n,t){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(){200==r.status||0==r.status&&r.response?n(r.response):t()},r.onerror=t,r.send(null)};var s,l,c,u=t.print||console.log.bind(console),m=t.printErr||console.warn.bind(console);for(n in r)r.hasOwnProperty(n)&&(t[n]=r[n]);r=null,t.arguments&&t.arguments,t.thisProgram&&t.thisProgram,t.quit&&(i=t.quit),t.wasmBinary&&(s=t.wasmBinary),t.noExitRuntime&&(l=t.noExitRuntime),"object"!=typeof WebAssembly&&m("no native wasm support detected");var f=new WebAssembly.Table({initial:153,maximum:153,element:"anyfunc"}),d=!1;function p(e,n){e||U("Assertion failed: "+n)}function _(e){var n=t["_"+e];return p(n,"Cannot call unknown function "+e+", make sure it is exported"),n}function g(e,n,t,r,a){var i={string:function(e){var n=0;if(null!=e&&0!==e){var t=1+(e.length<<2);!function(e,n,t){!function(e,n,t,r){if(!(r>0))return 0;for(var a=t+r-1,i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o>=55296&&o<=57343){var s=e.charCodeAt(++i);o=65536+((1023&o)<<10)|1023&s}if(o<=127){if(t>=a)break;n[t++]=o}else if(o<=2047){if(t+1>=a)break;n[t++]=192|o>>6,n[t++]=128|63&o}else if(o<=65535){if(t+2>=a)break;n[t++]=224|o>>12,n[t++]=128|o>>6&63,n[t++]=128|63&o}else{if(t+3>=a)break;n[t++]=240|o>>18,n[t++]=128|o>>12&63,n[t++]=128|o>>6&63,n[t++]=128|63&o}}n[t]=0}(e,y,n,t)}(e,n=se(t),t)}return n},array:function(e){var n=se(e.length);return k(e,n),n}};function o(e){return"string"===n?S(e):"boolean"===n?Boolean(e):e}var s=_(e),l=[],c=0;if(r)for(var u=0;u<r.length;u++){var m=i[t[u]];m?(0===c&&(c=oe()),l[u]=m(r[u])):l[u]=r[u]}var f=s.apply(null,l),d=(a&&a.async,"object"==typeof J&&J.currData),p="object"==typeof J&&J.asyncFinalizers.length>0;return d&&!p?new Promise((function(e){J.asyncFinalizers.push((function(n){0!==c&&le(c),e(o(n))}))})):(f=o(f),0!==c&&le(c),a&&a.async?Promise.resolve(f):f)}var h,b,y,v,w,L="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function C(e,n,t){for(var r=n+t,a=n;e[a]&&!(a>=r);)++a;if(a-n>16&&e.subarray&&L)return L.decode(e.subarray(n,a));for(var i="";n<a;){var o=e[n++];if(128&o){var s=63&e[n++];if(192!=(224&o)){var l=63&e[n++];if((o=224==(240&o)?(15&o)<<12|s<<6|l:(7&o)<<18|s<<12|l<<6|63&e[n++])<65536)i+=String.fromCharCode(o);else{var c=o-65536;i+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else i+=String.fromCharCode((31&o)<<6|s)}else i+=String.fromCharCode(o)}return i}function S(e,n){return e?C(y,e,n):""}function k(e,n){b.set(e,n)}function A(e){h=e,t.HEAP8=b=new Int8Array(e),t.HEAP16=new Int16Array(e),t.HEAP32=v=new Int32Array(e),t.HEAPU8=y=new Uint8Array(e),t.HEAPU16=new Uint16Array(e),t.HEAPU32=w=new Uint32Array(e),t.HEAPF32=new Float32Array(e),t.HEAPF64=new Float64Array(e)}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");var R=t.INITIAL_MEMORY||16777216;function E(e){for(;e.length>0;){var n=e.shift();if("function"!=typeof n){var r=n.func;"number"==typeof r?void 0===n.arg?t.dynCall_v(r):t.dynCall_vi(r,n.arg):r(void 0===n.arg?null:n.arg)}else n(t)}}(c=t.wasmMemory?t.wasmMemory:new WebAssembly.Memory({initial:R/65536,maximum:32768}))&&(h=c.buffer),R=h.byteLength,A(h),v[69088]=5519392;var x=[],F=[],M=[],D=[],P=0,z=null;function B(e){P++,t.monitorRunDependencies&&t.monitorRunDependencies(P)}function N(e){if(P--,t.monitorRunDependencies&&t.monitorRunDependencies(P),0==P&&z){var n=z;z=null,n()}}function U(e){throw t.onAbort&&t.onAbort(e),u(e+=""),m(e),d=!0,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.",new WebAssembly.RuntimeError(e)}function X(e){return n=e,t="data:application/octet-stream;base64,",String.prototype.startsWith?n.startsWith(t):0===n.indexOf(t);var n,t}t.preloadedImages={},t.preloadedAudios={};var q,O="libflashrom.wasm";function T(){try{if(s)return new Uint8Array(s);throw"both async and sync fetching of the wasm failed"}catch(e){U(e)}}function H(e){try{return c.grow(e-h.byteLength+65535>>>16),A(c.buffer),1}catch(e){}}X(O)||(q=O,O=t.locateFile?t.locateFile(q,o):o+q),F.push({func:function(){te()}});var W,j={mappings:{},buffers:[null,[],[]],printChar:function(e,n){var t=j.buffers[e];0===n||10===n?((1===e?u:m)(C(t,0)),t.length=0):t.push(n)},varargs:void 0,get:function(){return j.varargs+=4,v[j.varargs-4>>2]},getStr:function(e){return S(e)},get64:function(e,n){return e}},Y={device:null,interfaceNumber:-1};function V(e){for(var n=W();W()-n<e/1e3;);}function G(e){return v[ie()>>2]=e,e}function $(e,n){if(K.mainLoop.timingMode=e,K.mainLoop.timingValue=n,!K.mainLoop.func)return 1;if(0==e)K.mainLoop.scheduler=function(){var e=0|Math.max(0,K.mainLoop.tickStartTime+n-W());setTimeout(K.mainLoop.runner,e)},K.mainLoop.method="timeout";else if(1==e)K.mainLoop.scheduler=function(){K.requestAnimationFrame(K.mainLoop.runner)},K.mainLoop.method="rAF";else if(2==e){if("undefined"==typeof setImmediate){var t=[];addEventListener("message",(function(e){"setimmediate"!==e.data&&"setimmediate"!==e.data.target||(e.stopPropagation(),t.shift()())}),!0),setImmediate=function(e){t.push(e),postMessage("setimmediate","*")}}K.mainLoop.scheduler=function(){setImmediate(K.mainLoop.runner)},K.mainLoop.method="immediate"}return 0}W=function(){return performance.now()};var K={mainLoop:{scheduler:null,method:"",currentlyRunningMainloop:0,func:null,arg:0,timingMode:0,timingValue:0,currentFrameNumber:0,queue:[],pause:function(){K.mainLoop.scheduler=null,K.mainLoop.currentlyRunningMainloop++},resume:function(){K.mainLoop.currentlyRunningMainloop++;var e=K.mainLoop.timingMode,n=K.mainLoop.timingValue,r=K.mainLoop.func;K.mainLoop.func=null,function(e,n,r,a,i){var o;l=!0,p(!K.mainLoop.func,"emscripten_set_main_loop: there can only be one main loop function at once: call emscripten_cancel_main_loop to cancel the previous one before setting a new one with different parameters."),K.mainLoop.func=e,K.mainLoop.arg=a,o=void 0!==a?function(){t.dynCall_vi(e,a)}:function(){t.dynCall_v(e)};var s=K.mainLoop.currentlyRunningMainloop;if(K.mainLoop.runner=function(){if(!d)if(K.mainLoop.queue.length>0){var e=Date.now(),n=K.mainLoop.queue.shift();if(n.func(n.arg),K.mainLoop.remainingBlockers){var t=K.mainLoop.remainingBlockers,r=t%1==0?t-1:Math.floor(t);n.counted?K.mainLoop.remainingBlockers=r:(r+=.5,K.mainLoop.remainingBlockers=(8*t+r)/9)}if(console.log('main loop blocker "'+n.name+'" took '+(Date.now()-e)+" ms"),K.mainLoop.updateStatus(),s<K.mainLoop.currentlyRunningMainloop)return;setTimeout(K.mainLoop.runner,0)}else s<K.mainLoop.currentlyRunningMainloop||(K.mainLoop.currentFrameNumber=K.mainLoop.currentFrameNumber+1|0,1==K.mainLoop.timingMode&&K.mainLoop.timingValue>1&&K.mainLoop.currentFrameNumber%K.mainLoop.timingValue!=0?K.mainLoop.scheduler():(0==K.mainLoop.timingMode&&(K.mainLoop.tickStartTime=W()),K.mainLoop.runIter(o),s<K.mainLoop.currentlyRunningMainloop||("object"==typeof SDL&&SDL.audio&&SDL.audio.queueNewAudioData&&SDL.audio.queueNewAudioData(),K.mainLoop.scheduler())))},i||(n&&n>0?$(0,1e3/n):$(1,1),K.mainLoop.scheduler()),r)throw"unwind"}(r,0,!1,K.mainLoop.arg,!0),$(e,n),K.mainLoop.scheduler()},updateStatus:function(){if(t.setStatus){var e=t.statusMessage||"Please wait...",n=K.mainLoop.remainingBlockers,r=K.mainLoop.expectedBlockers;n?n<r?t.setStatus(e+" ("+(r-n)+"/"+r+")"):t.setStatus(e):t.setStatus("")}},runIter:function(e){if(!d){if(t.preMainLoop&&!1===t.preMainLoop())return;try{e()}catch(e){if(e instanceof ce)return;throw e&&"object"==typeof e&&e.stack&&m("exception thrown: "+[e,e.stack]),e}t.postMainLoop&&t.postMainLoop()}}},isFullscreen:!1,pointerLock:!1,moduleContextCreatedCallbacks:[],workers:[],init:function(){if(t.preloadPlugins||(t.preloadPlugins=[]),!K.initted){K.initted=!0;try{new Blob,K.hasBlobConstructor=!0}catch(e){K.hasBlobConstructor=!1,console.log("warning: no blob constructor, cannot create blobs with mimetypes")}K.BlobBuilder="undefined"!=typeof MozBlobBuilder?MozBlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:K.hasBlobConstructor?null:console.log("warning: no BlobBuilder"),K.URLObject="undefined"!=typeof window?window.URL?window.URL:window.webkitURL:void 0,t.noImageDecoding||void 0!==K.URLObject||(console.log("warning: Browser does not support creating object URLs. Built-in browser image decoding will not be available."),t.noImageDecoding=!0);var e={canHandle:function(e){return!t.noImageDecoding&&/\.(jpg|jpeg|png|bmp)$/i.test(e)},handle:function(e,n,r,a){var i=null;if(K.hasBlobConstructor)try{(i=new Blob([e],{type:K.getMimetype(n)})).size!==e.length&&(i=new Blob([new Uint8Array(e).buffer],{type:K.getMimetype(n)}))}catch(e){!function e(n){e.shown||(e.shown={}),e.shown[n]||(e.shown[n]=1,m(n))}("Blob constructor present but fails: "+e+"; falling back to blob builder")}if(!i){var o=new K.BlobBuilder;o.append(new Uint8Array(e).buffer),i=o.getBlob()}var s=K.URLObject.createObjectURL(i),l=new Image;l.onload=function(){p(l.complete,"Image "+n+" could not be decoded");var a=document.createElement("canvas");a.width=l.width,a.height=l.height,a.getContext("2d").drawImage(l,0,0),t.preloadedImages[n]=a,K.URLObject.revokeObjectURL(s),r&&r(e)},l.onerror=function(e){console.log("Image "+s+" could not be decoded"),a&&a()},l.src=s}};t.preloadPlugins.push(e);var n={canHandle:function(e){return!t.noAudioDecoding&&e.substr(-4)in{".ogg":1,".wav":1,".mp3":1}},handle:function(e,n,r,a){var i=!1;function o(a){i||(i=!0,t.preloadedAudios[n]=a,r&&r(e))}function s(){i||(i=!0,t.preloadedAudios[n]=new Audio,a&&a())}if(!K.hasBlobConstructor)return s();try{var l=new Blob([e],{type:K.getMimetype(n)})}catch(e){return s()}var c=K.URLObject.createObjectURL(l),u=new Audio;u.addEventListener("canplaythrough",(function(){o(u)}),!1),u.onerror=function(t){i||(console.log("warning: browser could not fully decode audio "+n+", trying slower base64 approach"),u.src="data:audio/x-"+n.substr(-3)+";base64,"+function(e){for(var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t="",r=0,a=0,i=0;i<e.length;i++)for(r=r<<8|e[i],a+=8;a>=6;){var o=r>>a-6&63;a-=6,t+=n[o]}return 2==a?(t+=n[(3&r)<<4],t+="=="):4==a&&(t+=n[(15&r)<<2],t+="="),t}(e),o(u))},u.src=c,K.safeSetTimeout((function(){o(u)}),1e4)}};t.preloadPlugins.push(n);var r=t.canvas;r&&(r.requestPointerLock=r.requestPointerLock||r.mozRequestPointerLock||r.webkitRequestPointerLock||r.msRequestPointerLock||function(){},r.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock||document.msExitPointerLock||function(){},r.exitPointerLock=r.exitPointerLock.bind(document),document.addEventListener("pointerlockchange",a,!1),document.addEventListener("mozpointerlockchange",a,!1),document.addEventListener("webkitpointerlockchange",a,!1),document.addEventListener("mspointerlockchange",a,!1),t.elementPointerLock&&r.addEventListener("click",(function(e){!K.pointerLock&&t.canvas.requestPointerLock&&(t.canvas.requestPointerLock(),e.preventDefault())}),!1))}function a(){K.pointerLock=document.pointerLockElement===t.canvas||document.mozPointerLockElement===t.canvas||document.webkitPointerLockElement===t.canvas||document.msPointerLockElement===t.canvas}},createContext:function(e,n,r,a){if(n&&t.ctx&&e==t.canvas)return t.ctx;var i,o;if(n){var s={antialias:!1,alpha:!1,majorVersion:1};if(a)for(var l in a)s[l]=a[l];"undefined"!=typeof GL&&(o=GL.createContext(e,s))&&(i=GL.getContext(o).GLctx)}else i=e.getContext("2d");return i?(r&&(n||p("undefined"==typeof GLctx,"cannot set in module if GLctx is used, but we are a non-GL context that would replace it"),t.ctx=i,n&&GL.makeContextCurrent(o),t.useWebGL=n,K.moduleContextCreatedCallbacks.forEach((function(e){e()})),K.init()),i):null},destroyContext:function(e,n,t){},fullscreenHandlersInstalled:!1,lockPointer:void 0,resizeCanvas:void 0,requestFullscreen:function(e,n){K.lockPointer=e,K.resizeCanvas=n,void 0===K.lockPointer&&(K.lockPointer=!0),void 0===K.resizeCanvas&&(K.resizeCanvas=!1);var r=t.canvas;function a(){K.isFullscreen=!1;var e=r.parentNode;(document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement||document.webkitCurrentFullScreenElement)===e?(r.exitFullscreen=K.exitFullscreen,K.lockPointer&&r.requestPointerLock(),K.isFullscreen=!0,K.resizeCanvas?K.setFullscreenCanvasSize():K.updateCanvasDimensions(r)):(e.parentNode.insertBefore(r,e),e.parentNode.removeChild(e),K.resizeCanvas?K.setWindowedCanvasSize():K.updateCanvasDimensions(r)),t.onFullScreen&&t.onFullScreen(K.isFullscreen),t.onFullscreen&&t.onFullscreen(K.isFullscreen)}K.fullscreenHandlersInstalled||(K.fullscreenHandlersInstalled=!0,document.addEventListener("fullscreenchange",a,!1),document.addEventListener("mozfullscreenchange",a,!1),document.addEventListener("webkitfullscreenchange",a,!1),document.addEventListener("MSFullscreenChange",a,!1));var i=document.createElement("div");r.parentNode.insertBefore(i,r),i.appendChild(r),i.requestFullscreen=i.requestFullscreen||i.mozRequestFullScreen||i.msRequestFullscreen||(i.webkitRequestFullscreen?function(){i.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}:null)||(i.webkitRequestFullScreen?function(){i.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)}:null),i.requestFullscreen()},exitFullscreen:function(){return!!K.isFullscreen&&((document.exitFullscreen||document.cancelFullScreen||document.mozCancelFullScreen||document.msExitFullscreen||document.webkitCancelFullScreen||function(){}).apply(document,[]),!0)},nextRAF:0,fakeRequestAnimationFrame:function(e){var n=Date.now();if(0===K.nextRAF)K.nextRAF=n+1e3/60;else for(;n+2>=K.nextRAF;)K.nextRAF+=1e3/60;var t=Math.max(K.nextRAF-n,0);setTimeout(e,t)},requestAnimationFrame:function(e){"function"!=typeof requestAnimationFrame?(0,K.fakeRequestAnimationFrame)(e):requestAnimationFrame(e)},safeCallback:function(e){return function(){if(!d)return e.apply(null,arguments)}},allowAsyncCallbacks:!0,queuedAsyncCallbacks:[],pauseAsyncCallbacks:function(){K.allowAsyncCallbacks=!1},resumeAsyncCallbacks:function(){if(K.allowAsyncCallbacks=!0,K.queuedAsyncCallbacks.length>0){var e=K.queuedAsyncCallbacks;K.queuedAsyncCallbacks=[],e.forEach((function(e){e()}))}},safeRequestAnimationFrame:function(e){return K.requestAnimationFrame((function(){d||(K.allowAsyncCallbacks?e():K.queuedAsyncCallbacks.push(e))}))},safeSetTimeout:function(e,n){return l=!0,setTimeout((function(){d||(K.allowAsyncCallbacks?e():K.queuedAsyncCallbacks.push(e))}),n)},safeSetInterval:function(e,n){return l=!0,setInterval((function(){d||K.allowAsyncCallbacks&&e()}),n)},getMimetype:function(e){return{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",bmp:"image/bmp",ogg:"audio/ogg",wav:"audio/wav",mp3:"audio/mpeg"}[e.substr(e.lastIndexOf(".")+1)]},getUserMedia:function(e){window.getUserMedia||(window.getUserMedia=navigator.getUserMedia||navigator.mozGetUserMedia),window.getUserMedia(e)},getMovementX:function(e){return e.movementX||e.mozMovementX||e.webkitMovementX||0},getMovementY:function(e){return e.movementY||e.mozMovementY||e.webkitMovementY||0},getMouseWheelDelta:function(e){var n=0;switch(e.type){case"DOMMouseScroll":n=e.detail/3;break;case"mousewheel":n=e.wheelDelta/120;break;case"wheel":switch(n=e.deltaY,e.deltaMode){case 0:n/=100;break;case 1:n/=3;break;case 2:n*=80;break;default:throw"unrecognized mouse wheel delta mode: "+e.deltaMode}break;default:throw"unrecognized mouse wheel event: "+e.type}return n},mouseX:0,mouseY:0,mouseMovementX:0,mouseMovementY:0,touches:{},lastTouches:{},calculateMouseEvent:function(e){if(K.pointerLock)"mousemove"!=e.type&&"mozMovementX"in e?K.mouseMovementX=K.mouseMovementY=0:(K.mouseMovementX=K.getMovementX(e),K.mouseMovementY=K.getMovementY(e)),"undefined"!=typeof SDL?(K.mouseX=SDL.mouseX+K.mouseMovementX,K.mouseY=SDL.mouseY+K.mouseMovementY):(K.mouseX+=K.mouseMovementX,K.mouseY+=K.mouseMovementY);else{var n=t.canvas.getBoundingClientRect(),r=t.canvas.width,a=t.canvas.height,i=void 0!==window.scrollX?window.scrollX:window.pageXOffset,o=void 0!==window.scrollY?window.scrollY:window.pageYOffset;if("touchstart"===e.type||"touchend"===e.type||"touchmove"===e.type){var s=e.touch;if(void 0===s)return;var l=s.pageX-(i+n.left),c=s.pageY-(o+n.top),u={x:l*=r/n.width,y:c*=a/n.height};if("touchstart"===e.type)K.lastTouches[s.identifier]=u,K.touches[s.identifier]=u;else if("touchend"===e.type||"touchmove"===e.type){var m=K.touches[s.identifier];m||(m=u),K.lastTouches[s.identifier]=m,K.touches[s.identifier]=u}return}var f=e.pageX-(i+n.left),d=e.pageY-(o+n.top);f*=r/n.width,d*=a/n.height,K.mouseMovementX=f-K.mouseX,K.mouseMovementY=d-K.mouseY,K.mouseX=f,K.mouseY=d}},asyncLoad:function(e,n,t,r){var i=r?"":"al "+e;a(e,(function(t){p(t,'Loading data file "'+e+'" failed (no arrayBuffer).'),n(new Uint8Array(t)),i&&N()}),(function(n){if(!t)throw'Loading data file "'+e+'" failed.';t()})),i&&B()},resizeListeners:[],updateResizeListeners:function(){var e=t.canvas;K.resizeListeners.forEach((function(n){n(e.width,e.height)}))},setCanvasSize:function(e,n,r){var a=t.canvas;K.updateCanvasDimensions(a,e,n),r||K.updateResizeListeners()},windowedWidth:0,windowedHeight:0,setFullscreenCanvasSize:function(){if("undefined"!=typeof SDL){var e=w[SDL.screen>>2];e|=8388608,v[SDL.screen>>2]=e}K.updateCanvasDimensions(t.canvas),K.updateResizeListeners()},setWindowedCanvasSize:function(){if("undefined"!=typeof SDL){var e=w[SDL.screen>>2];e&=-8388609,v[SDL.screen>>2]=e}K.updateCanvasDimensions(t.canvas),K.updateResizeListeners()},updateCanvasDimensions:function(e,n,r){n&&r?(e.widthNative=n,e.heightNative=r):(n=e.widthNative,r=e.heightNative);var a=n,i=r;if(t.forcedAspectRatio&&t.forcedAspectRatio>0&&(a/i<t.forcedAspectRatio?a=Math.round(i*t.forcedAspectRatio):i=Math.round(a/t.forcedAspectRatio)),(document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement||document.webkitCurrentFullScreenElement)===e.parentNode&&"undefined"!=typeof screen){var o=Math.min(screen.width/a,screen.height/i);a=Math.round(a*o),i=Math.round(i*o)}K.resizeCanvas?(e.width!=a&&(e.width=a),e.height!=i&&(e.height=i),void 0!==e.style&&(e.style.removeProperty("width"),e.style.removeProperty("height"))):(e.width!=n&&(e.width=n),e.height!=r&&(e.height=r),void 0!==e.style&&(a!=n||i!=r?(e.style.setProperty("width",a+"px","important"),e.style.setProperty("height",i+"px","important")):(e.style.removeProperty("width"),e.style.removeProperty("height"))))},wgetRequests:{},nextWgetRequestHandle:0,getNextWgetRequestHandle:function(){var e=K.nextWgetRequestHandle;return K.nextWgetRequestHandle++,e}};function Z(e){try{return e()}catch(e){U(e)}}var J={State:{Normal:0,Unwinding:1,Rewinding:2},state:0,StackSize:4096,currData:null,handleSleepReturnValue:0,exportCallStack:[],callStackNameToId:{},callStackIdToFunc:{},callStackId:0,afterUnwind:null,asyncFinalizers:[],sleepCallbacks:[],getCallStackId:function(e){var n=J.callStackNameToId[e];return void 0===n&&(n=J.callStackId++,J.callStackNameToId[e]=n,J.callStackIdToFunc[n]=t.asm[e]),n},instrumentWasmExports:function(e){var n={};for(var r in e)!function(r){var a=e[r];n[r]="function"==typeof a?function(){J.exportCallStack.push(r);try{return a.apply(null,arguments)}finally{if(d)return;var e=J.exportCallStack.pop(r);p(e===r),J.currData&&J.state===J.State.Unwinding&&0===J.exportCallStack.length&&(J.state=J.State.Normal,Z(t._asyncify_stop_unwind),"undefined"!=typeof Fibers&&Fibers.trampoline(),J.afterUnwind&&(J.afterUnwind(),J.afterUnwind=null))}}:a}(r);return n},allocateData:function(){var e=ae(12+J.StackSize);return J.setDataHeader(e,e+12,J.StackSize),J.setDataRewindFunc(e),e},setDataHeader:function(e,n,t){v[e>>2]=n,v[e+4>>2]=n+t},setDataRewindFunc:function(e){var n=J.exportCallStack[0],t=J.getCallStackId(n);v[e+8>>2]=t},getDataRewindFunc:function(e){var n=v[e+8>>2];return J.callStackIdToFunc[n]},handleSleep:function(e){if(!d){if(l=!0,J.state===J.State.Normal){var n=!1,r=!1;e((function(e){if(!d&&(J.handleSleepReturnValue=e||0,n=!0,r)){J.state=J.State.Rewinding,Z((function(){t._asyncify_start_rewind(J.currData)})),K.mainLoop.func&&K.mainLoop.resume();var a=J.getDataRewindFunc(J.currData)();if(!J.currData){var i=J.asyncFinalizers;J.asyncFinalizers=[],i.forEach((function(e){e(a)}))}}})),r=!0,n||(J.state=J.State.Unwinding,J.currData=J.allocateData(),Z((function(){t._asyncify_start_unwind(J.currData)})),K.mainLoop.func&&K.mainLoop.pause())}else J.state===J.State.Rewinding?(J.state=J.State.Normal,Z(t._asyncify_stop_rewind),re(J.currData),J.currData=null,J.sleepCallbacks.forEach((function(e){e()}))):U("invalid state: "+J.state);return J.handleSleepReturnValue}}};t.requestFullscreen=function(e,n){K.requestFullscreen(e,n)},t.requestAnimationFrame=function(e){K.requestAnimationFrame(e)},t.setCanvasSize=function(e,n,t){K.setCanvasSize(e,n,t)},t.pauseMainLoop=function(){K.mainLoop.pause()},t.resumeMainLoop=function(){K.mainLoop.resume()},t.getUserMedia=function(){K.getUserMedia()},t.createContext=function(e,n,t,r){return K.createContext(e,n,t,r)};var Q={emscripten_get_sbrk_ptr:function(){return 276352},emscripten_memcpy_big:function(e,n,t){y.copyWithin(e,n,n+t)},emscripten_resize_heap:function(e){var n=y.length;if(e>2147483648)return!1;for(var t,r,a=1;a<=4;a*=2){var i=n*(1+.2/a);if(i=Math.min(i,e+100663296),H(Math.min(2147483648,((t=Math.max(16777216,e,i))%(r=65536)>0&&(t+=r-t%r),t))))return!0}return!1},exit:function(e){!function(e,n){n&&l&&0===e||(l||(d=!0,t.onExit&&t.onExit(e)),i(e,new ce(e)))}(e)},fd_close:function(e){return 0},fd_seek:function(e,n,t,r,a){},fd_write:function(e,n,t,r){for(var a=0,i=0;i<t;i++){for(var o=v[n+8*i>>2],s=v[n+(8*i+4)>>2],l=0;l<s;l++)j.printChar(e,y[o+l]);a+=s}return v[r>>2]=a,0},init_raiden_device:function(e,n,t,r){return J.handleSleep((async function(a){const i=S(e);console.log("Looking for raiden with serialno "+i);const o=(await navigator.usb.getDevices()).find(n=>0==e||n.serialNumber==i);if(o){console.log("Found raiden "+o.serialNumber),await o.open(),null===o.configuration&&await o.selectConfiguration(1);const e=o.configuration.interfaces.find(e=>{for(const n of e.alternates)if(255==n.interfaceClass&&81==n.interfaceSubclass)return!0;return!1});if(e){Y.interfaceNumber=e.interfaceNumber,w[n>>2]=Y.interfaceNumber,await o.claimInterface(Y.interfaceNumber);const i=e.alternate.endpoints.find(e=>"in"==e.direction),s=e.alternate.endpoints.find(e=>"out"==e.direction);return w[t>>2]=128|i.endpointNumber,w[r>>2]=s.endpointNumber,Y.device=o,void a(0)}}a(1)}))},libusb_bulk_transfer:function(e,n,t,r,a,i){return J.handleSleep((async function(e){if(128&n){let e=await Y.device.transferIn(-129&n,r);if(e.data){const n=new Uint8Array(e.data.buffer);w[a>>2]=e.data.byteLength,k(n,t)}else w[a>>2]=0}else{let e=new Uint8Array(r);e.set(y.subarray(t,t+r));let i=await Y.device.transferOut(n,e);"ok"==i.status?w[a>>2]=i.bytesWritten:w[a>>2]=0}e(0)}))},libusb_control_transfer:function(e,n,t,r,a,i,o,s){return J.handleSleep((async function(e){switch((await Y.device.controlTransferOut({requestType:"vendor",recipient:"interface",request:t,value:r,index:a})).status){case"ok":e(0);break;default:e(1)}}))},libusb_init:function(){return"usb"in navigator?0:1},memory:c,nanosleep:function(e,n){if(0===e)return G(28),-1;var t=v[e>>2],r=v[e+4>>2];return r<0||r>999999999||t<0?(G(28),-1):(0!==n&&(v[n>>2]=0,v[n+4>>2]=0),V(1e6*t+r/1e3))},setTempRet0:function(e){},table:f,usleep:V},ee=function(){var e={env:Q,wasi_snapshot_preview1:Q};function n(e,n){var r=e.exports;r=J.instrumentWasmExports(r),t.asm=r,N()}function r(e){n(e.instance)}function a(n){return(s||"function"!=typeof fetch?new Promise((function(e,n){e(T())})):fetch(O,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+O+"'";return e.arrayBuffer()})).catch((function(){return T()}))).then((function(n){return WebAssembly.instantiate(n,e)})).then(n,(function(e){m("failed to asynchronously prepare wasm: "+e),U(e)}))}if(B(),t.instantiateWasm)try{var i=t.instantiateWasm(e,n);return i=J.instrumentWasmExports(i)}catch(e){return m("Module.instantiateWasm callback failed with error: "+e),!1}return function(){if(s||"function"!=typeof WebAssembly.instantiateStreaming||X(O)||"function"!=typeof fetch)return a(r);fetch(O,{credentials:"same-origin"}).then((function(n){return WebAssembly.instantiateStreaming(n,e).then(r,(function(e){m("wasm streaming compile failed: "+e),m("falling back to ArrayBuffer instantiation"),a(r)}))}))}(),{}}();t.asm=ee;var ne,te=t.___wasm_call_ctors=function(){return(te=t.___wasm_call_ctors=t.asm.__wasm_call_ctors).apply(null,arguments)},re=t._free=function(){return(re=t._free=t.asm.free).apply(null,arguments)},ae=t._malloc=function(){return(ae=t._malloc=t.asm.malloc).apply(null,arguments)},ie=t.___errno_location=function(){return(ie=t.___errno_location=t.asm.__errno_location).apply(null,arguments)},oe=(t._flashrom_image_read=function(){return(t._flashrom_image_read=t.asm.flashrom_image_read).apply(null,arguments)},t._flashrom_image_write=function(){return(t._flashrom_image_write=t.asm.flashrom_image_write).apply(null,arguments)},t._flashrom_version_info=function(){return(t._flashrom_version_info=t.asm.flashrom_version_info).apply(null,arguments)},t._flashrom_supported_programmers=function(){return(t._flashrom_supported_programmers=t.asm.flashrom_supported_programmers).apply(null,arguments)},t._flashrom_data_free=function(){return(t._flashrom_data_free=t.asm.flashrom_data_free).apply(null,arguments)},t._flashrom_programmer_shutdown=function(){return(t._flashrom_programmer_shutdown=t.asm.flashrom_programmer_shutdown).apply(null,arguments)},t._flashrom_flash_getsize=function(){return(t._flashrom_flash_getsize=t.asm.flashrom_flash_getsize).apply(null,arguments)},t._flashrom_flash_getname=function(){return(t._flashrom_flash_getname=t.asm.flashrom_flash_getname).apply(null,arguments)},t._flashrom_flash_getvendor=function(){return(t._flashrom_flash_getvendor=t.asm.flashrom_flash_getvendor).apply(null,arguments)},t._flashrom_flash_release=function(){return(t._flashrom_flash_release=t.asm.flashrom_flash_release).apply(null,arguments)},t._wasm_flashrom_lib_init=function(){return(t._wasm_flashrom_lib_init=t.asm.wasm_flashrom_lib_init).apply(null,arguments)},t._wasm_setup_programmer=function(){return(t._wasm_setup_programmer=t.asm.wasm_setup_programmer).apply(null,arguments)},t._wasm_probe_flash=function(){return(t._wasm_probe_flash=t.asm.wasm_probe_flash).apply(null,arguments)},t.stackSave=function(){return(oe=t.stackSave=t.asm.stackSave).apply(null,arguments)}),se=t.stackAlloc=function(){return(se=t.stackAlloc=t.asm.stackAlloc).apply(null,arguments)},le=t.stackRestore=function(){return(le=t.stackRestore=t.asm.stackRestore).apply(null,arguments)};function ce(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function ue(e){function n(){ne||(ne=!0,t.calledRun=!0,d||(E(F),E(M),t.onRuntimeInitialized&&t.onRuntimeInitialized(),function(){if(t.postRun)for("function"==typeof t.postRun&&(t.postRun=[t.postRun]);t.postRun.length;)e=t.postRun.shift(),D.unshift(e);var e;E(D)}()))}P>0||(function(){if(t.preRun)for("function"==typeof t.preRun&&(t.preRun=[t.preRun]);t.preRun.length;)e=t.preRun.shift(),x.unshift(e);var e;E(x)}(),P>0||(t.setStatus?(t.setStatus("Running..."),setTimeout((function(){setTimeout((function(){t.setStatus("")}),1),n()}),1)):n()))}if(t.__growWasmMemory=function(){return(t.__growWasmMemory=t.asm.__growWasmMemory).apply(null,arguments)},t.dynCall_iiii=function(){return(t.dynCall_iiii=t.asm.dynCall_iiii).apply(null,arguments)},t.dynCall_ii=function(){return(t.dynCall_ii=t.asm.dynCall_ii).apply(null,arguments)},t.dynCall_iiiii=function(){return(t.dynCall_iiiii=t.asm.dynCall_iiiii).apply(null,arguments)},t.dynCall_i=function(){return(t.dynCall_i=t.asm.dynCall_i).apply(null,arguments)},t.dynCall_vii=function(){return(t.dynCall_vii=t.asm.dynCall_vii).apply(null,arguments)},t.dynCall_vi=function(){return(t.dynCall_vi=t.asm.dynCall_vi).apply(null,arguments)},t.dynCall_iii=function(){return(t.dynCall_iii=t.asm.dynCall_iii).apply(null,arguments)},t.dynCall_iiiiii=function(){return(t.dynCall_iiiiii=t.asm.dynCall_iiiiii).apply(null,arguments)},t.dynCall_iidiiii=function(){return(t.dynCall_iidiiii=t.asm.dynCall_iidiiii).apply(null,arguments)},t.dynCall_jiji=function(){return(t.dynCall_jiji=t.asm.dynCall_jiji).apply(null,arguments)},t._asyncify_start_unwind=function(){return(t._asyncify_start_unwind=t.asm.asyncify_start_unwind).apply(null,arguments)},t._asyncify_stop_unwind=function(){return(t._asyncify_stop_unwind=t.asm.asyncify_stop_unwind).apply(null,arguments)},t._asyncify_start_rewind=function(){return(t._asyncify_start_rewind=t.asm.asyncify_start_rewind).apply(null,arguments)},t._asyncify_stop_rewind=function(){return(t._asyncify_stop_rewind=t.asm.asyncify_stop_rewind).apply(null,arguments)},t.asm=ee,t.cwrap=function(e,n,t,r){var a=(t=t||[]).every((function(e){return"number"===e}));return"string"!==n&&a&&!r?_(e):function(){return g(e,n,t,arguments,r)}},t.then=function(e){if(ne)e(t);else{var n=t.onRuntimeInitialized;t.onRuntimeInitialized=function(){n&&n(),e(t)}}return t},z=function e(){ne||ue(),ne||(z=e)},t.run=ue,t.preInit)for("function"==typeof t.preInit&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return l=!0,ue(),t.api={wasm_flashrom_lib_init:t.cwrap("wasm_flashrom_lib_init",null,[]),flashrom_version_info:t.cwrap("flashrom_version_info","string",[]),wasm_setup_programmer:t.cwrap("wasm_setup_programmer","number",["string"],{async:!0}),wasm_probe_flash:t.cwrap("wasm_probe_flash","number",["number"],{async:!0}),flashrom_programmer_shutdown:t.cwrap("flashrom_programmer_shutdown","number",["number"],{async:!0}),flashrom_image_read:t.cwrap("flashrom_image_read","number",["number","number","number"],{async:!0}),flashrom_image_write:t.cwrap("flashrom_image_write","number",["number","number","number","number"],{async:!0}),flashrom_flash_getsize:t.cwrap("flashrom_flash_getsize","number",["number"]),flashrom_flash_getname:t.cwrap("flashrom_flash_getname","string",["number"]),flashrom_flash_getvendor:t.cwrap("flashrom_flash_getvendor","string",["number"]),flashrom_flash_release:t.cwrap("flashrom_flash_release",null,["number"])},e});let B;const N=z({locateFile:function(e,n){return e.endsWith("libflashrom.wasm")?"https://cdn.glitch.com/d68e5429-9bed-421c-8d97-def2c83b3c62%2Flibflashrom.wasm?v=1589963204087":n+e}}).then(e=>{delete e.then,B=N.api,B.wasm_flashrom_lib_init(),console.log("Flashrom version "+B.flashrom_version_info()+" loaded")}),U=(e,n)=>({type:"FLASHROM_CHIP_FOUND",size:e,flashName:n}),X={reading:!1,writing:!1,size:-1,flashName:""};L.addReducers({flashrom:(e=X,n)=>{switch(n.type){case"FLASHROM_CHIP_FOUND":return c(c({},e),{},{size:n.size,flashName:n.flashName});case"FLASHROM_CHIP_READ":return c(c({},e),{},{reading:!0});case"FLASHROM_CHIP_READ_FINISHED":return c(c({},e),{},{reading:!1});case"FLASHROM_CHIP_WRITE":return c(c({},e),{},{writing:!0});case"FLASHROM_CHIP_WRITE_FINISHED":return c(c({},e),{},{writing:!1});default:return e}}});class q extends(C(L)(S)){static get styles(){return[v(t||(t=l`.controls{display:flex;flex-wrap:wrap;align-items:center;justify-content:center;padding:16px}.spaced{padding-right:16px;padding-left:16px}.fname,.fsize{display:flex;justify-content:center;padding:16px}`))]}static get properties(){return{_flashName:String,_size:Number,_reading:Boolean,_writing:Boolean,_serialNumber:String}}stateChanged(e){this._flashName=e.flashrom.flashName,this._size=e.flashrom.size,this._writing=e.flashrom.writing,this._reading=e.flashrom.reading,this._serialNumber=e.usb.devices[0].serialNumber}render(){const{_serialNumber:e,_flashName:n,_size:t,_reading:c,_writing:u,_fileSelector:m}=this,f=c||u;return b(r||(r=l` <div class="flashrom"> <div class="fname"> ${0} </div> <div class="fsize"> ${0} </div> ${0} <div class="controls"> <mwc-button class="spaced" raised label="Read AP Flash" icon="cloud_download" ?disabled="${0}" @click="${0}"></mwc-button> <mwc-button class="spaced" raised label="Write AP Flash" icon="cloud_upload" ?disabled="${0}" @click="${0}"></mwc-button> </div> </div> <input type="file" id="file-selector" style="display:none"> `),n?b(a||(a=l` Found ${0} flash chip `),n):"",t>=0?b(i||(i=l` Size is ${0} `),t):"",b(f?o||(o=l` <mwc-linear-progress indeterminate></mwc-linear-progress> `):s||(s=l``)),1==f,L.dispatch((d=e,async e=>{e({type:"FLASHROM_CHIP_READ"}),await N;const n="target=ap,serial="+d,t=await B.wasm_setup_programmer(n),r=await B.wasm_probe_flash(t),a=B.flashrom_flash_getsize(r),i=B.flashrom_flash_getvendor(r)+" "+B.flashrom_flash_getname(r);e(U(a,i));const o=N._malloc(a),s=await B.flashrom_image_read(r,o,a);console.log(s),B.flashrom_flash_release(r),B.flashrom_programmer_shutdown(t);const l=new Uint8Array(N.HEAP8.buffer,o,a),c=new Uint8Array(l),u=new Blob([c],{type:"application/binary"});N._free(o);const m=URL.createObjectURL(u),f=document.createElement("a");f.href=m,f.download="wasm-firmware.bin",f.click(),e({type:"FLASHROM_CHIP_READ_FINISHED"})})),1==f,L.dispatch(((e,n)=>async t=>{t({type:"FLASHROM_CHIP_WRITE"});const r="target=ap,serial="+e,a=await B.wasm_setup_programmer(r),i=await B.wasm_probe_flash(a),o=B.flashrom_flash_getsize(i),s=B.flashrom_flash_getvendor(i)+" "+B.flashrom_flash_getname(i);t(U(o,s));const l=await new Promise((function(e,t){n.addEventListener("change",n=>{const r=n.target.files[0],a=new FileReader;a.addEventListener("load",n=>{n.target.result.byteLength!==o?t(Error("Length does not match")):e(new Uint8Array(n.target.result))}),a.addEventListener("error",t(Error("Something went wrong"))),a.addEventListener("abort",t(Error("User aborted"))),a.readAsArrayBuffer(r)}),n.click()})),c=N._malloc(o);console.log(l),N.HEAP8.set(l,c);const u=await B.flashrom_image_write(i,c,o,0);console.log(u),B.flashrom_flash_release(i),B.flashrom_programmer_shutdown(a),N._free(c),t({type:"FLASHROM_CHIP_WRITE"})})(e,m)));var d}firstUpdated(){this._fileSelector=this.shadowRoot.querySelector("#file-selector")}}customElements.define("hdctools-flashrom-view",q);
//# sourceMappingURL=3a6758cc.js.map
